# Kiwoom Pro Algo-Trader v3.1

키움증권 OpenAPI+를 활용한 전문가용 자동매매 프로그램입니다. 검증된 변동성 돌파 전략을 기반으로 다양한 보조지표 필터를 결합하여 안정적인 수익을 추구합니다.

## ✨ 주요 기능

### 1. 매매 전략 (Algorithm)
- **변동성 돌파 전략**: (전일 고가 - 전일 저가) × K + 당일 시가 돌파 시 매수
- **이동평균 필터**: 주가가 5일 이동평균선 위에 있을 때만 진입
- **보조지표 필터**:
  - **MACD**: 골든크로스 및 상승 추세 확인
  - **볼린저 밴드**: 밴드 하단 돌파(저점 매수) 또는 밴드 폭 확인
  - **DMI/ADX**: ADX 20 이상 및 P-DI > M-DI (강한 상승 추세)
  - **RSI**: 과매수(70 이상) 구간 진입 방지
  - **거래량**: 5일 평균 거래량 대비 폭증 시 진입
  - **ATR**: 변동성 지표를 활용한 동적 손절

### 2. 리스크 관리 (Risk Management)
- **트레일링 스톱**: 수익 보전을 위해 고점 대비 일정 비율 하락 시 자동 매도
- **ATR 동적 손절**: 시장 변동성에 따라 유동적으로 손절 라인 조정
- **손절매**: 매수자금 대비 일정 손실 도달 시 즉시 청산
- **일일 손실 한도**: 당일 누적 손실이 기준치를 넘으면 매매 자동 중단
- **시간 청산**: 장 마감(15:20) 전 전량 매도

### 3. 편의 기능
| 기능 | 설명 |
|------|------|
| 🔔 Toast 알림 | 비침습적 알림 시스템 (v3.1) |
| 📤 일괄 매도 | 모든 보유 종목 시장가 매도 (2중 확인) |
| 🔄 설정 초기화 | 모든 설정을 기본값으로 복원 |
| 📺 HiDPI 지원 | 고해상도 디스플레이 최적화 |
| 🖥️ 시스템 트레이 | 최소화 시 트레이 아이콘으로 숨김 |
| 📋 프리셋 관리 | 공격/표준/보수적 및 사용자 정의 설정 |
| 📊 거래 통계 | 승률, 수익금, 거래 횟수 실시간 표시 |
| 📝 거래 내역 | CSV 파일 내보내기 지원 |

## 🛠️ 설치 및 실행

### 요구 사항
- **OS**: Windows 10/11
- **Python**: 3.8 ~ 3.11 **(32-bit 필수)**
- **Kiwoom**: [키움증권 OpenAPI+](https://www1.kiwoom.com/h/customer/download/VOpenApiInfoView) 설치 필요

### 설치
```bash
pip install pyqt5
```

### 실행
```bash
python "키움증권 자동매매.py"
```

### PyInstaller 빌드
```bash
pip install pyinstaller
pyinstaller KiwoomProTrader.spec
```
빌드 결과물은 `dist/KiwoomProTrader.exe`에 생성됩니다.

## ⚠️ 주의사항
- 본 프로그램은 투자 보조 도구이며, **투자의 책임은 전적으로 사용자에게 있습니다.**
- 실계좌 사용 전 반드시 모의투자로 전략을 검증하세요.
- 키움증권 서버 점검 시간(자정 등)에는 접속이 불가능할 수 있습니다.

## 📜 Version History
| 버전 | 주요 변경사항 |
|------|--------------|
| v3.1 | Toast 알림, 일괄 매도, 설정 초기화, HiDPI 지원 |
| v3.0 | MACD/BB/DMI 필터, 시스템 트레이, 프리셋 관리자 |
| v2.0 | UI 개선, 로그 관리 강화 |
| v1.0 | 초기 변동성 돌파 전략 구현 |
